{
  # Global options
  auto_https off
  admin 0.0.0.0:2019
}

# Local development configuration
localhost:80, 127.0.0.1:80 {
  # Reverse proxy to Next.js application
  reverse_proxy web:8080 {
    # Preserve original headers
    header_upstream X-Forwarded-Host {http.request.host}
    header_upstream X-Forwarded-Proto {http.request.proto}
    header_upstream X-Forwarded-For {http.request.remote}
  }

  # Enable compression
  encode gzip

  # Logging
  log {
    output stdout
    format console
  }
}

# Health check endpoint
:8000 {
  respond /health "OK" 200
}
